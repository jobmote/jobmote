<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Job einstellen â€“ jobmote.de</title>

  <!-- wichtig fÃ¼r Unterseiten wie /post-job/ -->
  <base href="/" />

  <link rel="icon" type="image/png" href="/assets/favicon.png" />
  <link rel="stylesheet" href="/css/style.css" />
</head>

<body data-page="post-job">
  <header class="site-header">
    <div class="header-left">
      <a class="brand-link" href="/index.html" aria-label="Startseite">
        <img src="/assets/favicon.png" alt="jobmote.de" class="brand-icon" />
        jobmote.de
      </a>
    </div>

    <div class="header-center">
      <form id="site-search-form" class="search-form" action="/search.html" method="GET">
        <input
          id="site-search-input"
          class="search-bar"
          name="q"
          type="text"
          placeholder="Suche Jobs, Firmen, Keywordsâ€¦ ðŸ”Ž"
          autocomplete="off"
        />
      </form>
    </div>

    <div class="header-right">
      <button class="icon-btn" id="account-btn" type="button" aria-label="Account">
        <svg class="icon-svg-user" viewBox="0 0 24 24" aria-hidden="true">
          <circle cx="12" cy="8" r="4"></circle>
          <path d="M4 20c0-4 4-6 8-6s8 2 8 6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </button>
      <button
        class="icon-btn"
        id="menu-toggle"
        type="button"
        aria-label="MenÃ¼ Ã¶ffnen"
        aria-controls="side-menu"
        aria-expanded="false"
      >â˜°</button>
    </div>
  </header>

  <div id="menu-overlay" class="menu-overlay" aria-hidden="true"></div>

  <nav id="side-menu" class="side-menu" aria-label="SeitenmenÃ¼">
    <div class="side-menu-header">
      <span class="side-menu-title">MenÃ¼</span>
      <button class="close-btn" id="menu-close" type="button" aria-label="MenÃ¼ schlieÃŸen">âœ•</button>
    </div>
    <ul class="menu-list" id="menu-list"></ul>
  </nav>

  <main class="legal-container">
    <section class="legal-card">
      <h1>Job einstellen</h1>
      <p class="muted">Job wird in Supabase gespeichert (Owner = aktueller User).</p>

      <div class="notice" id="post-job-guard" hidden>
        <h3>Nur als Unternehmen</h3>
        <p class="muted">Bitte melde dich mit einem <strong>Company</strong>-Account an.</p>
        <div class="row">
          <a class="btn" href="/register/">Registrieren</a>
          <a class="btn btn-ghost" href="/login/">Anmelden</a>
        </div>
      </div>

      <form class="form" id="post-job-form">
        <div class="grid-2">
          <div class="form-group">
            <label for="pj-employer">Firma / Arbeitgeber <span class="req">*</span></label>
            <input id="pj-employer" type="text" placeholder="z.B. Beispiel GmbH" required />
          </div>

          <div class="form-group">
            <label for="pj-title">Jobtitel <span class="req">*</span></label>
            <input id="pj-title" type="text" placeholder="z.B. Lagerhelfer (m/w/d)" required />
          </div>
        </div>

        <div class="grid-2">
          <div class="form-group">
            <label for="pj-pay">Stundenlohn (â‚¬) <span class="req">*</span></label>
            <input id="pj-pay" type="number" step="0.01" min="0" placeholder="z.B. 16" required />
          </div>

          <div class="form-group">
            <label for="pj-hours">Stunden / Woche <span class="req">*</span></label>
            <input id="pj-hours" type="number" step="1" min="0" placeholder="z.B. 40" required />
          </div>
        </div>

        <div class="grid-3">
          <div class="form-group">
            <label for="pj-category">Kategorie</label>
            <select id="pj-category">
              <option>Support</option>
              <option>Logistik</option>
              <option>Produktion</option>
              <option>BÃ¼ro</option>
              <option>IT</option>
              <option>Vertrieb</option>
              <option>Sonstiges</option>
            </select>
          </div>

          <div class="form-group">
            <label for="pj-language">Sprache</label>
            <select id="pj-language">
              <option value="DE">DE</option>
              <option value="EN">EN</option>
            </select>
          </div>

          <div class="form-group">
            <label for="pj-region">Region</label>
            <select id="pj-region">
              <option value="DE">DE</option>
              <option value="AT">AT</option>
              <option value="CH">CH</option>
              <option value="EU">EU</option>
              <option value="Remote">Remote</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <label for="pj-link">Bewerbungslink</label>
          <input id="pj-link" type="url" placeholder="https://..." />
        </div>

        <div class="form-group">
          <label for="pj-desc">Beschreibung <span class="req">*</span></label>
          <textarea id="pj-desc" rows="6" maxlength="2000" placeholder="Kurze Stellenbeschreibungâ€¦" required></textarea>
          <div class="muted small">Max. 2000 Zeichen</div>
        </div>

        <div class="form-group">
          <label for="pj-req">Anforderungen (kommagetrennt)</label>
          <input id="pj-req" type="text" placeholder="z.B. Staplerschein, Deutsch, Schicht" />
        </div>

        <div class="form-group">
          <label>Firmenlogo (optional, max. 300 KB)</label>
          <div class="row" style="gap:10px; align-items:center;">
            <input id="pj-logo" type="file" accept="image/*" />
            <button id="pj-logo-clear" class="btn btn-ghost" type="button">Logo entfernen</button>
          </div>
          <div class="row" style="gap:10px; align-items:center; margin-top:10px;">
            <img
              id="pj-logo-preview"
              alt="Logo Vorschau"
              style="width:64px; height:64px; object-fit:cover; border-radius:12px; display:none;"
            />
            <span class="muted small">Vorschau</span>
          </div>
        </div>

        <hr />

        <h3 style="margin: 10px 0;">Live-Vorschau</h3>
        <div id="pj-card-preview"></div>

        <div class="row" style="margin-top: 16px; gap: 10px;">
          <button class="btn" type="submit">Job verÃ¶ffentlichen</button>
          <a class="btn btn-ghost" href="/my-posted-jobs.html">Abbrechen</a>
        </div>

        <p class="muted" id="post-job-msg" role="status" aria-live="polite"></p>
      </form>
    </section>
  </main>

  <!-- Core -->
  <script defer src="/js/core.js"></script>
  <script defer src="/js/theme.js"></script>

  <!-- Auth (einzige Quelle) -->
  <script type="module" src="/js/auth-session.js"></script>

  <!-- Guard NACH auth-session, VOR page.postjob -->
  <script type="module">
    const wait = (ms) => new Promise(r => setTimeout(r, ms));

    while (!window.JM || !window.JM.authReady) await wait(30);
    try { await window.JM.authReady; } catch {}

    const u = window.JM.getCurrentUser?.();
    const ok = !!u && window.JM.isCompany?.();

    if (!ok) {
      const guard = document.getElementById("post-job-guard");
      const form = document.getElementById("post-job-form");
      if (guard) guard.hidden = false;
      if (form) form.style.display = "none";
      if (!u) location.replace("/login/");
    }
  </script>

  <!-- App libs -->
  <script defer src="/js/jobs.data.js"></script>
  <script defer src="/js/jobs.service.js"></script>
  <script defer src="/js/favorites.v2.js"></script>
  <script defer src="/js/ui.menu.js"></script>
  <script defer src="/js/render.js"></script>
  <script defer src="/js/ui.modal.js"></script>
  <script defer src="/js/page.search.js"></script>

  <!-- Post Job -->
  <script defer src="/js/page.postjob.js?v=2"></script>

  <script defer src="/js/app.js"></script>
</body>
</html>
